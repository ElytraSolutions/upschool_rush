import{a as f,r as a}from"./react-f4831f7c.js";import{p as d}from"./page-flip-1af2e518.js";const m=f.forwardRef((e,u)=>{const o=a.useRef(null),l=a.useRef([]),r=a.useRef(),[c,s]=a.useState([]);a.useImperativeHandle(u,()=>({pageFlip:()=>r.current}));const g=a.useCallback(()=>{r.current&&r.current.clear()},[]),h=a.useCallback(()=>{const n=r.current;n&&(n.off("flip"),n.off("changeOrientation"),n.off("changeState"),n.off("init"),n.off("update"))},[]);return a.useEffect(()=>{if(l.current=[],e.children){const n=f.Children.map(e.children,i=>f.cloneElement(i,{ref:t=>{t&&l.current.push(t)}}));(!e.renderOnlyPageLengthChange||c.length!==n.length)&&(n.length<c.length&&g(),s(n))}},[e.children]),a.useEffect(()=>{const n=()=>{const i=r.current;i&&(e.onFlip&&i.on("flip",t=>e.onFlip(t)),e.onChangeOrientation&&i.on("changeOrientation",t=>e.onChangeOrientation(t)),e.onChangeState&&i.on("changeState",t=>e.onChangeState(t)),e.onInit&&i.on("init",t=>e.onInit(t)),e.onUpdate&&i.on("update",t=>e.onUpdate(t)))};c.length>0&&l.current.length>0&&(h(),o.current&&!r.current&&(r.current=new d.PageFlip(o.current,e)),r.current.getFlipController()?r.current.updateFromHtml(l.current):r.current.loadFromHTML(l.current),n())},[c]),f.createElement("div",{ref:o,className:e.className,style:e.style},c)}),H=f.memo(m);export{H};
